<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informacion del cliente</title>
    <link rel="stylesheet"
          type="text/css"
          href="../node_modules/bootstrap/dist/css/bootstrap.css"/>
    <style>
        main { 
            margin-top: 2%;
            padding-left: 30%;
            padding-right: 30%;
        }
        form {
            height: 70%;
        }
        .banner {
            background-color: maroon;
            padding: 4%;
        }
    </style>
</head>
<body onload="tryFillCustomerData()">
    <main class="container">
        <div class="container rounded-top banner">
            <img class="" src="../IMGs/librePensador2.webp" height="19%" width="19%">
        </div>
        <form class="shadow p-3 mb-5 bg-body rounded" id="customerForm">
            <div class="mb-3">
              <label for="email" class="form-label">Email del cliente</label>
              <input type="email" class="form-control" id="email" required>
            </div>
            <div class="mb-3">
              <label for="name" class="form-label">Nombre del cliente</label>
              <input type="text" class="form-control" id="name" disabled>
            </div>
            <div class="mb-3">
                <label for="phone_number" class="form-label">Numero celular</label>
                <input type="text" class="form-control" id="phone_number" disabled>
            </div>
            <div class="mb-3">
                <label for="address" class="form-label">Direccion</label>
                <input type="text" class="form-control" id="address" disabled>
            </div>
            <div class="mb-3">
                <label for="total_points" class="form-label">Total de puntos</label>
                <input type="text" class="form-control" id="total_points" disabled>
            </div>
            <div class="mb-3">
                <label for="date_of_birth" class="form-label">Fecha de nacimiento</label>
                <input type="date" class="form-control" id="date_of_birth" disabled>
            </div>
            <div class="mb-3">
                <label for="pointsToAdd" class="form-label">Puntos que se van a añadir</label>
                <input type="number" class="form-control" id="pointsToAdd">
            </div>

            <button onclick="tryUpdateCustomerPoints()" type="submit" class="btn btn-primary" id="btnAddPointsToCard" disabled>Añadir puntos a la tarjeta</button>
        </form>
    </main>
    <script>
        function tryFillCustomerData() {
            let card_id = sessionStorage.getItem("scannedCardCode");
            if(!isCardLinked(card_id)) {
                alert("La tarjeta escaneada no a sido enlazada con un cliente, favor de escanear una tarjeta valida");
                window.location.href = rootFolder + "addPointsToCard/scanner.html";
                return;
            }

            if ( fillCustomerFormData(email) == undefined ) {
                window.location.href = rootFolder + "addPointsToCard/scanner.html";
                return;
            }

            document.getElementById("pointsToAdd").required = true;
            document.getElementById("btnAddPointsToCard").disabled = false;

        }

        function tryUpdateCustomerPoints() {
            if(!document.getElementById("customerForm").checkValidity())
                return;
            addToCustomerPoints(document.getElementById("pointsToAdd"), document.getElementById("email"));
        }
    </script>
    <script src="../scripts/include.js"></script>
    <script src="../scripts/fillCustomerData.js"></script>
    <script src="../scripts/cardStatus.js"></script>
    <script src="../scripts/updateCustomerPoints.js"></script>
</body>
</html>
